import { useEffect } from "react";
import { Section } from "./app";
import { useTheme } from "./context";
import { Hamburger } from "./hamburger";
import { SearchBox } from "./search-box";
import "./styles/header.css";

interface HeaderProps {
  readonly authed: boolean;
  readonly section: Section;
  readonly menuOpen: boolean;
  readonly setMenuOpen: React.Dispatch<React.SetStateAction<boolean>>;
}

export const Header = ({
  authed,
  section,
  menuOpen,
  setMenuOpen,
}: HeaderProps): JSX.Element => {
  const { theme } = useTheme();

  useEffect(() => {
    setMenuOpen(false);
  }, [setMenuOpen, authed]);

  return (
    <header className={`header${menuOpen ? " opaque" : ""}`}>
      <div className="header-container">
        <svg
          width="63"
          height="25"
          viewBox="0 0 535 127"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M44.8148 127C36.3477 127 29.0298 126.065 22.861 124.196C16.8131 122.327 12.0353 119.664 8.52751 116.206C5.1407 112.749 3.26585 108.777 2.90298 104.291H29.7556C30.2394 106.721 32.0537 108.59 35.1986 109.898C38.3435 111.3 42.2747 112.001 46.992 112.001C54.2495 112.001 59.3902 110.74 62.4141 108.216C65.559 105.787 67.1314 102.235 67.1314 97.5629V84.5265H65.8614C63.4422 88.7318 59.6321 91.9558 54.4309 94.1987C49.2297 96.348 43.4238 97.4227 37.013 97.4227C28.6669 97.4227 21.7119 95.9742 16.1478 93.0773C10.7047 90.1803 6.65267 86.0684 3.9916 80.7417C1.33053 75.3216 0 69.0603 0 61.9581V61.3973C0 53.454 1.45149 46.819 4.35447 41.4923C7.37841 36.1656 11.6724 32.1939 17.2365 29.5773C22.8005 26.8672 29.4532 25.5121 37.1944 25.5121C44.8148 25.5121 50.9231 26.6336 55.5195 28.8764C60.1159 31.0258 63.5632 33.9227 65.8614 37.5673H67.3129L68.7644 26.9139H95.0726V95.0397C95.0726 102.329 93.1373 108.31 89.2667 112.982C85.396 117.748 79.711 121.253 72.2117 123.496C64.8332 125.832 55.701 127 44.8148 127ZM48.4435 80.3212C54.3704 80.3212 58.9668 78.9661 62.2327 76.2561C65.4985 73.4525 67.1314 69.8547 67.1314 65.4625V57.6126C67.1314 54.5287 66.3452 51.8653 64.7728 49.6225C63.2003 47.3797 61.0231 45.6508 58.2411 44.436C55.58 43.2211 52.3141 42.6137 48.4435 42.6137C44.5729 42.6137 41.2465 43.2211 38.4645 44.436C35.6825 45.6508 33.5657 47.333 32.1142 49.4823C30.6627 51.6317 29.937 54.2483 29.937 57.3322V66.0232C29.937 69.0136 30.6627 71.5835 32.1142 73.7329C33.6867 75.7888 35.8639 77.4242 38.6459 78.6391C41.428 79.7605 44.6938 80.3212 48.4435 80.3212Z"
            fill={theme === "dark" ? "#f7f8f8" : "#000"}
          />
          <path
            d="M110.853 102.189V43.5949C110.853 38.5486 112.849 34.5302 116.841 31.5397C120.832 28.4559 126.034 26.9139 132.444 26.9139H172.179V44.2958H138.795V102.189H110.853Z"
            fill={theme === "dark" ? "#f7f8f8" : "#000"}
          />
          <path
            d="M181.869 102.189V26.9139H209.81V102.189H181.869ZM181.869 17.3819V0H209.81V17.3819H181.869Z"
            fill={theme === "dark" ? "#f7f8f8" : "#000"}
          />
          <path
            d="M260.239 102.189C252.498 102.189 246.934 100.647 243.547 97.5629C240.281 94.479 238.648 90.4606 238.648 85.5077V37.287H266.589V85.3675H289.45V102.189H260.239ZM217.602 44.2958V26.9139H238.648V3.36424H266.589V26.9139H290.539V44.2958H217.602Z"
            fill={theme === "dark" ? "#f7f8f8" : "#000"}
          />
          <path
            d="M303.154 102.189V0H329.825V102.189H303.154Z"
            fill={theme === "dark" ? "#f7f8f8" : "#000"}
          />
          <path
            d="M386.694 103.45C379.316 103.45 372.663 102.609 366.736 100.927C360.809 99.1516 355.669 96.5817 351.314 93.2174C346.96 89.8532 343.633 85.7881 341.335 81.0221C339.037 76.1626 337.888 70.6957 337.888 64.6214C337.888 56.865 339.823 50.0898 343.694 44.2958C347.564 38.4084 353.129 33.8293 360.386 30.5585C367.643 27.2877 376.413 25.6523 386.694 25.6523C393.952 25.6523 400.544 26.5401 406.471 28.3157C412.398 30.0912 417.478 32.6611 421.711 36.0254C426.066 39.3896 429.392 43.4547 431.69 48.2207C434.11 52.9868 435.319 58.4536 435.319 64.6214C435.319 72.2844 433.384 79.0596 429.513 84.947C425.643 90.741 420.079 95.2734 412.821 98.5441C405.685 101.815 396.976 103.45 386.694 103.45ZM386.513 86.7693C390.867 86.7693 394.677 85.975 397.943 84.3863C401.33 82.7042 403.87 80.2277 405.564 76.9569C407.378 73.6862 408.285 69.5743 408.285 64.6214C408.285 60.8834 407.801 57.6593 406.834 54.9492C405.866 52.1457 404.415 49.8094 402.479 47.9404C400.544 46.0714 398.246 44.7163 395.585 43.8753C392.924 42.9408 389.96 42.4735 386.694 42.4735C382.34 42.4735 378.469 43.2678 375.082 44.8565C371.816 46.4452 369.276 48.8749 367.462 52.1457C365.648 55.4165 364.74 59.575 364.74 64.6214C364.74 68.3595 365.224 71.6302 366.192 74.4338C367.281 77.1439 368.793 79.4334 370.728 81.3024C372.663 83.078 374.961 84.433 377.622 85.3675C380.284 86.3021 383.247 86.7693 386.513 86.7693Z"
            fill={theme === "dark" ? "#f7f8f8" : "#000"}
          />
          <path
            d="M485.831 127C477.243 127 469.864 126.019 463.696 124.056C457.527 122.187 452.688 119.524 449.181 116.066C445.673 112.702 443.677 108.73 443.193 104.151H468.776C469.26 105.74 470.227 107.142 471.679 108.357C473.251 109.665 475.247 110.646 477.666 111.3C480.206 112.048 483.109 112.422 486.375 112.422C491.576 112.422 495.749 111.814 498.894 110.599C502.16 109.478 504.519 107.796 505.97 105.553C507.543 103.31 508.329 100.46 508.329 97.0022V84.106H506.877C504.821 88.1243 501.132 91.3951 495.81 93.9183C490.609 96.4415 484.5 97.7031 477.485 97.7031C471.679 97.7031 466.417 96.9555 461.7 95.4603C457.103 93.8716 453.112 91.582 449.725 88.5916C446.338 85.5077 443.738 81.723 441.923 77.2373C440.109 72.7517 439.202 67.5651 439.202 61.6777C439.202 53.7344 440.774 47.0993 443.919 41.7726C447.185 36.4459 451.66 32.4275 457.345 29.7174C463.151 27.0074 469.925 25.6523 477.666 25.6523C484.682 25.6523 490.79 26.9139 495.991 29.4371C501.192 31.8668 504.821 35.0909 506.877 39.1093H508.329L509.055 27.0541H535V93.2174C535 99.4787 533.79 104.759 531.371 109.057C529.073 113.356 525.747 116.814 521.392 119.43C517.038 122.141 511.837 124.056 505.789 125.178C499.862 126.393 493.209 127 485.831 127ZM487.282 81.8631C491.879 81.8631 495.689 81.1155 498.713 79.6203C501.737 78.1251 504.035 76.1626 505.607 73.7329C507.18 71.2097 508.087 68.6398 508.329 66.0232L508.147 57.0519C508.026 54.4352 507.18 51.9588 505.607 49.6225C504.035 47.1928 501.737 45.2303 498.713 43.7351C495.689 42.2399 491.939 41.4923 487.464 41.4923C483.23 41.4923 479.48 42.2399 476.215 43.7351C473.07 45.1369 470.651 47.333 468.957 50.3234C467.264 53.3138 466.417 57.0986 466.417 61.6777C466.417 66.2568 467.264 70.0416 468.957 73.032C470.772 76.0224 473.251 78.2653 476.396 79.7605C479.541 81.1622 483.17 81.8631 487.282 81.8631Z"
            fill={theme === "dark" ? "#f7f8f8" : "#000"}
          />
        </svg>

        {authed && (
          <div className="cta-section">
            {section.type === "trainings" && <SearchBox />}
            <Hamburger menuOpen={menuOpen} setMenuOpen={setMenuOpen} />
          </div>
        )}
      </div>
      <hr />
    </header>
  );
};
